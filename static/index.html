
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AcceptXMR Demo</title>
<div class="payment-container">
    <div class=payment-qrcode-container>
        <img src="/qrcode.svg" alt="XMR Address QR Code"/>
    </div>
    <div class="payment-details">
        <div class="payment-message">
            <label for="message">Message (Optional)</label>
            <textarea type="text" id="message" name="message" rows="1" placeholder="Have anything you'd like to say?"></textarea>
        </div>
        <label>Address</label>
        <div class="payment-address-container">
            <p id="payment-address">4A1WSBQdCbUCqt3DaGfmqVFchXScF43M6c5r4B6JXT3dUwuALncU9XTEnRPmUMcB3c16kVP9Y7thFLCJ5BaMW3UmSy93w3w</p>
            <button id="payment-address-copy-btn" onclick="copyPaymentAddress()">Copy</button>
        </div>
        <label>Status</label>
        <p class="payment-status">
            Paid: 0.0000 / 0.035 XMR<br/>
            Confirmations: 0 / 10<br/>
            Current Block: 2459000
        </p>
    </div>
</div>

<style>
    body {
        background-color: #454545;
    }

    .payment-container {
        max-width: 80ch;
        margin: auto;
        background-color: #ff7700;
        border-radius: 1em;
        display: flex;
        flex-flow: row wrap;
    }

    .payment-container .payment-qrcode-container {
        flex: 1 1 10ch;
        margin: 1em;
        display: flex;
        justify-content: center;
    }

    .payment-container .payment-qrcode-container img {
        border-radius: 1em;
        min-width: 28ch;
        align-self: center;
    }

    .payment-container textarea {
        width: 100%;
        border-radius: 0.5em;
        border: 0;
        padding: 0.5em;
        background-color: #353535;
        color: #ffffff;
        resize: vertical;
    }

    .payment-container .payment-message {
        margin-bottom: 0.5em;
    }

    .payment-container .payment-details {
        flex: 2 2 30ch;
        margin: 1em;
        overflow: hidden;
    }

    .payment-container .payment-address-container {
        display: flex;        
        height: 3em;
        border-radius: 0.5em;
        margin-bottom: 0.5em;
        background-color: #ffffff;
    }

    .payment-container .payment-address-container p {
        overflow-x: scroll;
        overflow-y: hidden;
        margin: 0 0.5em 0 0.5em;
        height: 100%;
        display: flex;
        align-items: center;
    }

    .payment-container .payment-address-container button {
        background-color: #1F85DE;
        border-radius: 0 0.5em 0.5em 0;
        border: 0;
        margin: 0;
        height: 100%;
        padding: 0 1em;
        font-size: medium;
    }

    .payment-container .payment-status {
        margin: 0;
        border-radius: 0.5em;
        padding: 0.5em;
        background-color: #ffffff;
    }
</style>

<script>
    function copyPaymentAddress() {
        /* Get the text field */
        var copyText = document.getElementById("payment-address");

        /* Copy the text inside the text field */
        navigator.clipboard.writeText(copyText.innerHTML);

        /* Provide feedback */
        document.getElementById("payment-address-copy-btn").innerHTML = "Copied!";
        setTimeout(function(){
            document.getElementById("payment-address-copy-btn").innerHTML = "Copy";  
        },1000);
    } 

    let socket = new WebSocket("ws://localhost:8080/ws/");

    socket.onopen = function(e) {
        alert("[open] Connection established");
        alert("Sending to server");
        socket.send("This is a test string");
    };

    socket.onmessage = function(event) {
        alert(`[message] Data received from server: ${event.data}`);
    };

    socket.onclose = function(event) {
        if (event.wasClean) {
            alert(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`);
        } else {
            // e.g. server process killed or network down
            // event.code is usually 1006 in this case
            alert('[close] Connection died');
        }
    };

    socket.onerror = function(error) {
        alert(`[error] ${error.message}`);
    };
</script>